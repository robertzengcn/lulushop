$(function(){$('select[name="zone_country_id_shipping"]').change(function(){var concode=$("#country_shipping  option:selected").val();var token=document.getElementsByName('securityToken');var tokenvalue=token[0].value;if(concode==""){return false;};$.ajax({url:'/ajaxcheckpay/',data:{'action':"check_country",'code':concode,'securityToken':tokenvalue},type:'post',dataType:'json',error:function(data,message){},success:function(data){if(data.stute){if(data.kind==1){var html='';html='<option value="0">please choose State/Province/Region</option>';$('#povince_shipping_i').addClass('hide');$('#povince_shipping_s').removeClass('hide');$('#povince_shipping_s').empty().append(html);html='';$.each(data.date,function(n,value){html+='<option value="'+value.id+'">'+value.name+'</option>';});if(html!=''){$('#povince_shipping_s').append(html);}}else{$('#povince_shipping_i').removeClass('hide');$('#povince_shipping_s').addClass('hide');$('#povince_shipping_s').empty();}}}})});});$(function(){var hsel=document.getElementById('e_country_shipping');hsel.addEventListener("change",function(){var concode=$("#e_country_shipping  option:selected").val();var token=document.getElementsByName('securityToken');var tokenvalue=token[0].value;if(concode==""){return false;};$.ajax({url:'/ajaxcheckpay/',data:{'action':"check_country",'code':concode,'securityToken':tokenvalue},type:'post',dataType:'json',error:function(data,message){},success:function(data){if(data.stute){if(data.kind==1){var html='';html='<option value="0">please choose State/Province/Region</option>';$('#e_povince_shipping_i').addClass('hide');$('#e_povince_shipping_s').removeClass('hide');$('#e_povince_shipping_s').empty().append(html);html='';$.each(data.date,function(n,value){html+='<option value="'+value.id+'">'+value.name+'</option>';});if(html!=''){$('#e_povince_shipping_s').append(html);}}else{$('#e_povince_shipping_i').removeClass('hide');$('#e_povince_shipping_s').addClass('hide');$('#e_povince_shipping_s').empty();}}}})});});function updateorder(){var temp=document.getElementsByName("address");var fump=document.getElementsByName("shipping");var token=document.getElementsByName('securityToken');var tokenvalue=token[0].value;var subcost=$('#subcostnum').html();var symbol=$('#symbol').val();for(var i=0;i<fump.length;i++){if(fump[i].checked){var shipval=fump[i].value;}}
for(var i=0;i<temp.length;i++)
{if(temp[i].checked){var intHot=temp[i].value;}}
$.get("/index.php?main_page=checkout",{fecaction:"ajaxupdate",'id':intHot,'shipping':shipval,'securityToken':tokenvalue},function(data){if(data.stute){$('#shipway').html(data.detail.title+":");$('#shipprice').html(symbol+data.detail.cost);var num=$('#shipprice').html();var st=parseInt(num.replace(/[^0-9]/ig,""));var subnum=parseInt(subcost.replace(/[^0-9]/ig,""));var totcost=st+subnum;$('#totalcostnum').html(symbol+totcost);}},"JSON");}
$(function(){var rad=document.getElementsByName("address");var shi=document.getElementsByName("shipping");for(var i=0;i<shi.length;i++){shi[i].onclick=function(){updateorder();};}});function check_address(){var thefirst=$('#s_first').val();var thelast=$('#s_last').val();var addressliine=$('#addressline').val();var addresssec=$('#addressline_sec').val();var alladdress=addressliine+" "+addresssec;var city=$('#city').val();var country=$('#country_shipping option:selected').val();if($('#povince_shipping_i').hasClass("hide")){var state=$('#povince_shipping_s option:selected').val();}else{var state=$('#povince_shipping_i').val();}
var zipcode=$('#zidval').val();var phonecoe=$('#phonenum').val();var token=document.getElementsByName('securityToken');var tokenvalue=token[0].value;if(thefirst==""){$('#shaddmsg').html('<p><strong>please enter your first name</strong></p>');$("#s_first").addClass("focusedalert");$('#s_first').focus();$('#shaddmsg').removeClass("hide");return false;}
if(thelast==""){$('#shaddmsg').html('<p><strong>please enter your last name</strong></p>');$("#s_last").addClass("focusedalert");$('#shaddmsg').removeClass("hide");$('#s_last').focus();return false;}
if(addressliine==""&&addresssec==""){$('#shaddmsg').html('<p><strong>please enter your address</strong></p>');$("#addressline").addClass("focusedalert");$('#shaddmsg').removeClass("hide");$('#addressline').focus();return false;}
if(city==""){$('#shaddmsg').html('<p><strong>please enter your city</strong></p>');$("#city").addClass("focusedalert");$('#shaddmsg').removeClass("hide");$('#city').focus();return false;}
if(zipcode==""){$('#shaddmsg').html('<p><strong>please enter your zip code</strong></p>');$("#zidval").addClass("focusedalert");$('#shaddmsg').removeClass("hide");$('#zidval').focus();return false;}
if(phonecoe==""){$('#shaddmsg').html('<p><strong>please enter your phone number</strong></p>');$("#phonenum").addClass("focusedalert");$('#shaddmsg').removeClass("hide");$('#phonenum').focus();return false;}
$.ajax({url:'/ajaxcheckpay/',data:{'action':"set_address",'first_name':thefirst,'last_name':thelast,'address':alladdress,'city':city,'zip':zipcode,'country':country,'state':state,'phone':phonecoe,'securityToken':tokenvalue},type:'post',dataType:'json',error:function(data,message){$('#shaddmsg').html('<p><strong>there are something wrong happened, please try later</strong></p>');$('#shaddmsg').removeClass("hide");},success:function(data){var line="";if(data.stute){$("#adshipform").addClass("hide");line='<div class="radio"><label class="col-md-6"><input onclick="updateorder()" type="radio" checked="" value="'+data.id+'" name="address"><span id="edit_'+data.id+'" class="limitslab col-md-12 col-xs-12"/>'+data.address+'</span></label><div class="col-md-2"><a onclick="edi_address('+data.id+')">Edit</a></div></div>'
$("#addline").prepend(line);}else{$('#shaddmsg').html(data.msg);$('#shaddmsg').removeClass("hide");}}})}
$(document).ready(function(){$("#s_first").blur(function(){$("#s_first").removeClass("focusedalert");});$("#s_last").blur(function(){$("#s_last").removeClass("focusedalert");});$("#addressline").blur(function(){$("#addressline").removeClass("focusedalert");});$("#city").blur(function(){$("#city").removeClass("focusedalert");});$("#zidval").blur(function(){$("#zidval").removeClass("focusedalert");});$("#phonenum").blur(function(){$("#phonenum").removeClass("focusedalert");});});function setSelectChecked(selectId,checkValue){var select=document.getElementById(selectId);for(var i=0;i<select.options.length;i++){if(select.options[i].value==checkValue){select.options[i].selected=true;break;}}};function edi_address(id){var token=document.getElementsByName('securityToken');var tokenvalue=token[0].value;$.ajax({url:'/ajaxcheckpay/',data:{'action':"get_address",'id':id,'securityToken':tokenvalue},type:'post',dataType:'json',error:function(data,message){},success:function(data){if(data.stute){$("#e_first").val(data.date.firstname);$("#e_last").val(data.date.lastname);$("#e_addressline").val(data.date.street_address);$("#e_city").val(data.date.city);$("#e_zidval").val(data.date.postcode);$("#e_zidval").val(data.date.postcode);$("#e_phonenum").val(data.date.phonenum);$("#e_saveaddid").val(id);setSelectChecked("e_country_shipping",data.date.country_id);var diqucode=data.date.zone_id;$.ajax({url:'/ajaxcheckpay/',data:{'action':"check_country",'code':data.date.country_id,'securityToken':tokenvalue},type:'post',dataType:'json',error:function(data,message){},success:function(data){if(data.stute){if(data.kind==1){var html='';html='<option value="0">please choose State/Province/Region</option>';$('#e_povince_shipping_i').addClass('hide');$('#e_povince_shipping_s').removeClass('hide');$('#e_povince_shipping_s').empty().append(html);html='';$.each(data.date,function(n,value){html+='<option value="'+value.id+'">'+value.name+'</option>';});if(html!=''){$('#e_povince_shipping_s').append(html);if((diqucode!=0)&&(diqucode!="")){setSelectChecked("e_povince_shipping_s",diqucode);}}}else{$('#e_povince_shipping_i').removeClass('hide');$('#e_povince_shipping_s').addClass('hide');$('#e_povince_shipping_s').empty();}}}})
if((data.date.zone_id!=0)&&!isNaN(data.date.zone_id)){}
$('#editaddress').modal('show');}}})}
function add_address(){$("#s_first").val("");$("#s_last").val("");$("#addressline").val("");$("#povince_shipping_i").val("");$("#city").val("");$("#zidval").val("");$("#phonenum").val("");$("#addressline_sec").val("");$("#adshipform").removeClass("hide");}
function cancel_address(){$("#adshipform").addClass("hide");}
function cancel_update(){$('#editaddress').modal('hide');}
function update_address(){var efirst=$("#e_first").val();var elast=$("#e_last").val();var eaddress=$("#e_addressline").val();var ecity=$("#e_city").val();var ephone=$("#e_phonenum").val();var ezip=$("#e_zidval").val();var addid=$("#e_saveaddid").val();var ecountry=$('#e_country_shipping option:selected').val();var token=document.getElementsByName('securityToken');var tokenvalue=token[0].value;if($('#e_povince_shipping_i').hasClass("hide")){var estate=$('#e_povince_shipping_s option:selected').val();}else{var estate=$('#e_povince_shipping_i').val();}
if(efirst==""){$('#eadd_msg').html('<p><strong>please enter your first name</strong></p>');$("#e_first").addClass("focusedalert");$('#e_first').focus();$('#eadd_msg').removeClass("hide");return false;}
if(elast==""){$('#eadd_msg').html('<p><strong>please enter your last name</strong></p>');$("#e_last").addClass("focusedalert");$('#eadd_msg').removeClass("hide");$('#e_last').focus();return false;}
if(eaddress==""){$('#eadd_msg').html('<p><strong>please enter your address</strong></p>');$("#e_last").addClass("focusedalert");$('#eadd_msg').removeClass("hide");$('#e_last').focus();return false;}
if(ecity==""){$('#eadd_msg').html('<p><strong>please enter your city</strong></p>');$("#e_city").addClass("focusedalert");$('#eadd_msg').removeClass("hide");$('#e_city').focus();return false;}
if(ezip==""){$('#eadd_msg').html('<p><strong>please enter your zip code</strong></p>');$("#e_zidval").addClass("focusedalert");$('#eadd_msg').removeClass("hide");$('#e_zidval').focus();return false;}
if(ephone==""){$('#eadd_msg').html('<p><strong>please enter your phone number</strong></p>');$("#e_phonenum").addClass("focusedalert");$('#eadd_msg').removeClass("hide");$('#e_phonenum').focus();return false;}
if(ecountry==""){$('#eadd_msg').html('<p><strong>please choose your country</strong></p>');$("#e_country_shipping").addClass("focusedalert");$('#eadd_msg').removeClass("hide");return false;}
$.ajax({url:'/ajaxcheckpay/',data:{'action':"update_address",'first_name':efirst,'last_name':elast,'address':eaddress,'city':ecity,'zip':ezip,'country':ecountry,'state':estate,'saveaddid':addid,'phone':ephone,'securityToken':tokenvalue},type:'post',dataType:'json',error:function(data,message){},success:function(data){if(data.stute){$('#editaddress').modal('hide');$('#edit_'+data.id).html(data.address);}}})}